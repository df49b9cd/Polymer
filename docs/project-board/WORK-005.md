# WORK-005 – CI Gate for AOT Publish and Core Test Suites

## Goal
Block merges unless all affected OmniRelay hosts and MeshKit roles build/publish as Native AOT and pass targeted test suites.

## Scope
- CI jobs for `dotnet build OmniRelay.slnx`, targeted `dotnet test` slices, and `dotnet publish /p:PublishAot=true` per host/role.
- Mode-aware test matrix (in-proc, sidecar, edge; central, agent, bridge).
- Perf smoke (latency budget checks) optional but reported.

## Requirements
1. **Coverage** – Gate includes data-plane + control-plane binaries and CLI.
2. **Artifacts** – Publish signed artifacts; verify signatures in CI; store SBOM.
3. **Fail fast** – Banned APIs and perf regressions fail the gate (hooks from WORK-002).
4. **Configurability** – Allow scoped runs (changed files) while guaranteeing full runs in nightly.

## Deliverables
- CI definitions/scripts; matrix for hosts/roles/RIDs.
- Documentation of gates and how to rerun locally.

## Acceptance Criteria
- PRs blocked when AOT publish or tests fail for impacted components.
- Nightly full matrix green; artifacts signed and archived with manifests.

## Testing Strategy
- CI self-tests; simulate failures to ensure gate behavior.

## References
- `docs/architecture/OmniRelay.SRS.md`
- `docs/architecture/MeshKit.SRS.md`

## Status
Open.
